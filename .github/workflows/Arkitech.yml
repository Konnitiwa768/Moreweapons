name: Sync Fabric & Forge Sources

on:
  push:
    branches:
      - main  # å¿…è¦ã«å¿œã˜ã¦å¤‰æ›´ã—ã¦ãã ã•ã„

jobs:
  update-sources:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ” ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4

      - name: ğŸ—ƒï¸ src/ ã‚’ fabric/ ã«ç§»å‹•
        run: |
          rm -rf fabric
          mkdir -p fabric
          if [ -d src ]; then
            mv src fabric/
          fi

      - name: ğŸŒ å¤–éƒ¨ãƒªãƒã‚¸ãƒˆãƒª Konnitiwa768/Tconx ã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
        run: |
          git clone --depth 1 https://github.com/Konnitiwa768/Tconx.git temp_repo

      - name: ğŸ“‚ temp_repo/src ã‚’ forge/ ã«ç§»å‹•
        run: |
          rm -rf forge
          mkdir -p forge
          if [ -d temp_repo/src ]; then
            mv temp_repo/src forge/
          fi

      - name: ğŸ§¹ ä¸€æ™‚ãƒ•ã‚©ãƒ«ãƒ€ã‚’å‰Šé™¤
        run: rm -rf temp_repo

      - name: âœ… çµæœã‚’ã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥ï¼ˆè‡ªå‹•åŒ–ç”¨ï¼‰
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git pull
          git add fabric forge
          git commit -m "Auto: sync fabric and forge src on push" || echo "No changes to commit"
          git push
